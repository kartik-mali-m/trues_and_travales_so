@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@model ToursAndTravelsManagement.Models.CabRoutePrice
@using ToursAndTravelsManagement.Enums

@{
    ViewData["Title"] = "Cab Price Details";
    Layout = "_AdminLayout";
}

<div class="container-fluid">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-0 text-gray-800">
                <i class="fas fa-eye mr-2"></i>Cab Price Details
            </h1>
            <p class="text-muted mb-0">Full information for this pricing configuration</p>
        </div>
        <div>
            <a asp-action="ManageCabPrices" class="btn btn-secondary mr-2">
                <i class="fas fa-arrow-left mr-1"></i> Back to List
            </a>
            <a asp-action="EditCabPrice" asp-route-id="@Model.CabRoutePriceId" class="btn btn-primary">
                <i class="fas fa-edit mr-1"></i> Edit Price
            </a>
        </div>
    </div>

    <!-- Alerts -->
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show">
            @TempData["Success"]
            <button type="button" class="close" data-dismiss="alert">×</button>
        </div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show">
            @TempData["Error"]
            <button type="button" class="close" data-dismiss="alert">×</button>
        </div>
    }

    <div class="card shadow mb-4">
        <div class="card-header bg-primary text-white py-3">
            <h6 class="m-0 font-weight-bold">
                <i class="fas fa-money-bill-wave mr-2"></i>
                Price Configuration Details
            </h6>
        </div>

        <div class="card-body">

            <div class="row">

                <!-- Left Column - Cab & Route -->
                <div class="col-lg-6">

                    <h5 class="mb-3 border-bottom pb-2">
                        <i class="fas fa-car mr-2 text-primary"></i>Cab Information
                    </h5>

                    <dl class="row">
                        <dt class="col-sm-4">Cab Name</dt>
                        <dd class="col-sm-8">@Model.Cab.Name</dd>

                        <dt class="col-sm-4">Type / Category</dt>
                        <dd class="col-sm-8">@Model.Cab.Type</dd>

                        <dt class="col-sm-4">Model</dt>
                        <dd class="col-sm-8">@(Model.Cab.Model ?? "—")</dd>

                        <dt class="col-sm-4">Registration</dt>
                        <dd class="col-sm-8 font-monospace">@Model.Cab.RegistrationNumber</dd>

                        <dt class="col-sm-4">Seating Capacity</dt>
                        <dd class="col-sm-8">@Model.Cab.SeatingCapacity seats</dd>

                        <dt class="col-sm-4">Driver</dt>
                        <dd class="col-sm-8">
                            @Model.Cab.DriverName
                            @if (!string.IsNullOrWhiteSpace(Model.Cab.DriverPhone))
                            {
                                <span class="text-muted small ml-2">(@Model.Cab.DriverPhone)</span>
                            }
                            else
                            {
                                <span class="text-muted small ml-2">(no phone)</span>
                            }
                        </dd>
                    </dl>

               @*      <dl class="row">
                        <dt class="col-sm-4">Cab Name</dt>
                        <dd class="col-sm-8">@(Model.Cab?.Name ?? "—")</dd>

                        <dt class="col-sm-4">Type / Category</dt>
                        <dd class="col-sm-8">@(Model.Cab?.Type ?? "—")</dd>

                        <dt class="col-sm-4">Model</dt>
                        <dd class="col-sm-8">@(Model.Cab?.Model ?? "—")</dd>

                        <dt class="col-sm-4">Registration</dt>
                        <dd class="col-sm-8 font-monospace">@(Model.Cab?.RegistrationNumber ?? "—")</dd>

                        <dt class="col-sm-4">Seating Capacity</dt>
                        <dd class="col-sm-8">@(Model.Cab?.SeatingCapacity ?? 0) seats</dd>

                        <dt class="col-sm-4">Driver</dt>
                        <dd class="col-sm-8">
                            @(Model.Cab?.DriverName ?? "—")
                            @if (!string.IsNullOrEmpty(Model.Cab?.DriverPhone))
                            {
                                <span class="text-muted small ml-2">(@Model.Cab.DriverPhone)</span>
                            }
                        </dd>
                    </dl> *@

                    <h5 class="mt-5 mb-3 border-bottom pb-2">
                        <i class="fas fa-route mr-2 text-primary"></i>Route Information
                    </h5>

                    <dl class="row">
                        <dt class="col-sm-4">From</dt>
                        <dd class="col-sm-8">@(Model.Route?.FromCity?.Name ?? "—")</dd>

                        <dt class="col-sm-4">To</dt>
                        <dd class="col-sm-8">@(Model.Route?.ToCity?.Name ?? "—")</dd>

                        <dt class="col-sm-4">Distance</dt>
                        <dd class="col-sm-8">
                            @(Model.Route?.Distance > 0 ? Model.Route.Distance.ToString("N1") + " km" : "—")
                        </dd>

                        <dt class="col-sm-4">Est. Time</dt>
                   @*      <dd class="col-sm-8">
                            @{
                                var est = Model.Route?.EstimatedTime;
                                if (est.HasValue && est.Value > TimeSpan.Zero)
                                {
                                    var h = (int)est.Value.TotalHours;
                                    var m = est.Value.Minutes;
                                    @(h > 0 ? $"{h} hr{(h > 1 ? "s" : "")}" : "") @(m > 0 ? $"{m} min{(m > 1 ? "s" : "")}" : (h == 0 ? "—" : ""))
                                }
                                else
                                {
                                    @:—
                                }
                            }
                        </dd> *@

                        <dt class="col-sm-4">Journey Type</dt>
                        <dd class="col-sm-8">
                            <span class="badge @GetJourneyBadgeClass(Model.JourneyType)">
                                @Model.JourneyType
                            </span>
                        </dd>
                    </dl>

                </div>

                <!-- Right Column - Pricing & Meta -->
                <div class="col-lg-6">

                    <h5 class="mb-3 border-bottom pb-2">
                        <i class="fas fa-rupee-sign mr-2 text-primary"></i>Pricing
                    </h5>

                    <dl class="row">
                        <dt class="col-sm-5 h5 pt-2">Base Price</dt>
                        <dd class="col-sm-7">
                            <span class="h4 font-weight-bold text-success">₹@Model.Price.ToString("N0")</span>
                        </dd>

                        @if (!string.IsNullOrWhiteSpace(Model.ExtraCharges))
                        {
                            <dt class="col-sm-5">Extra Charges</dt>
                            <dd class="col-sm-7 text-warning">@Model.ExtraCharges</dd>
                        }

                        @if (!string.IsNullOrWhiteSpace(Model.IncludedServices))
                        {
                            <dt class="col-sm-5">Included Services</dt>
                            <dd class="col-sm-7">@Model.IncludedServices</dd>
                        }

                        @if (!string.IsNullOrWhiteSpace(Model.ExcludedServices))
                        {
                            <dt class="col-sm-5">Excluded Services</dt>
                            <dd class="col-sm-7">@Model.ExcludedServices</dd>
                        }
                    </dl>

                    <h5 class="mt-5 mb-3 border-bottom pb-2">
                        <i class="fas fa-sticky-note mr-2 text-primary"></i>Additional Info
                    </h5>

                    @if (!string.IsNullOrWhiteSpace(Model.Notes))
                    {
                        <div class="mb-3">
                            <strong>Notes:</strong>
                            <p class="bg-light p-3 rounded">@Model.Notes</p>
                        </div>
                    }

                    @if (!string.IsNullOrWhiteSpace(Model.TermsAndConditions))
                    {
                        <div class="mb-4">
                            <strong>Terms & Conditions:</strong>
                            <p class="bg-light p-3 rounded">@Model.TermsAndConditions</p>
                        </div>
                    }

                    <div class="mt-4">
                        <strong>Availability:</strong>
                        @if (Model.IsAvailable)
                        {
                            <span class="badge badge-success px-3 py-2">ACTIVE / Available</span>
                        }
                        else
                        {
                            <span class="badge badge-danger px-3 py-2">INACTIVE / Unavailable</span>
                        }
                    </div>

                    <div class="mt-3 text-muted small">
                        <div>Created: @Model.CreatedDate.ToString("dd MMM yyyy HH:mm")</div>
                        @if (!string.IsNullOrEmpty(Model.CreatedBy))
                        {
                            <div>By: @Model.CreatedBy</div>
                        }
                    </div>

                </div>

            </div><!-- row -->

        </div><!-- card-body -->

        <div class="card-footer text-right">
            <a asp-action="ManageCabPrices" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left mr-1"></i>Back to List
            </a>
            <a asp-action="EditCabPrice" asp-route-id="@Model.CabRoutePriceId" class="btn btn-primary ml-2">
                <i class="fas fa-edit mr-1"></i>Edit this Price
            </a>
        </div>
    </div>

</div>

@functions {
    string GetJourneyBadgeClass(JourneyType type) =>
        type switch
        {
            JourneyType.OneWay => "badge-warning",
            JourneyType.Outstation => "badge-primary",
            JourneyType.Local => "badge-info",
            JourneyType.Transfer => "badge-secondary",
            _ => "badge-light"
        };
}